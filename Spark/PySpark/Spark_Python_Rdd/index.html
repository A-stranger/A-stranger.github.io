<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>PySpark RDD | 学习大数据</title><meta name="author" content="XiaoQu"><meta name="copyright" content="XiaoQu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="RDD A Resilient Distributed Dataset (RDD), the basic abstraction in Spark. Represents an immutable(不可变的), partitioned collection(集合) of elements that can be operated o in parallel. This class contains">
<meta property="og:type" content="article">
<meta property="og:title" content="PySpark RDD">
<meta property="og:url" content="http://www.studybigdata.cn/Spark/PySpark/Spark_Python_Rdd/index.html">
<meta property="og:site_name" content="学习大数据">
<meta property="og:description" content="RDD A Resilient Distributed Dataset (RDD), the basic abstraction in Spark. Represents an immutable(不可变的), partitioned collection(集合) of elements that can be operated o in parallel. This class contains">
<meta property="og:locale">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2022-03-23T07:55:26.000Z">
<meta property="article:modified_time" content="2023-01-15T11:15:08.062Z">
<meta property="article:author" content="XiaoQu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.studybigdata.cn/Spark/PySpark/Spark_Python_Rdd/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="code-qvYtDCUlcS"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?057fccfc2b1bef4c0d79224d80660be0";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'PySpark RDD',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-01-15 19:15:08'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/jin.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">78</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">39</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">23</div></a></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">学习大数据</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">PySpark RDD</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-03-23T07:55:26.000Z" title="Created 2022-03-23 15:55:26">2022-03-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-01-15T11:15:08.062Z" title="Updated 2023-01-15 19:15:08">2023-01-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/PySpark/">PySpark</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="PySpark RDD"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="RDD"><a href="#RDD" class="headerlink" title="RDD"></a>RDD</h1><blockquote>
<p>A Resilient Distributed Dataset (<code>RDD</code>), the <code>basic abstraction</code> in Spark. Represents an <code>immutable</code>(不可变的), <code>partitioned collection(集合) of elements</code> that can be <code>operated o in parallel</code>. This <code>class</code> contains the basic operations available on all RDDs, such as <code>map</code>, <code>filter</code>, and <code>persist</code>. </p>
<p>In addition,</p>
<p><code>PairRDDFunctions(类)</code> contains operations <code>available only</code> on <code>RDDs of key-value pairs</code>, such as <code>groupByKey</code> and <code>join</code>; </p>
<p><code>DoubleRDDFunctions</code> contains operations available only on <code>RDDs of Doubles</code>; </p>
<p><code>SequenceFileRDDFunctions</code> contains operations available on RDDs that can be saved as <code>SequenceFiles</code>. </p>
<p>All operations are automatically available on any RDD of the right type (e.g. RDD[(Int, Int)]) through implicit(隐式).<br>Internally, each RDD is characterized by <code>five main properties</code>:</p>
<ul>
<li><p>A list of partitions</p>
</li>
<li><p>A function for computing each split</p>
</li>
<li><p>A list of dependencies on other RDDs</p>
</li>
<li><p>Optionally, a Partitioner for key-value RDDs (e.g. to say that the RDD is hash-partitioned)</p>
</li>
<li><p>Optionally, <code>a list of preferred locations</code> to compute each <code>split</code> on (e.g. block locations for an HDFS file)</p>
</li>
</ul>
<p>All of the scheduling and execution in Spark is done based on these methods, allowing each RDD to implement its own way of computing itself. Indeed（实际上）, users can implement custom RDDs (e.g. for reading data from a new storage system) by <code>overriding</code> these functions. Please refer to(查阅) the <a target="_blank" rel="noopener" href="http://people.csail.mit.edu/matei/papers/2012/nsdi_spark.pdf">Spark paper</a>  for more details on RDD internals.</p>
</blockquote>
<h2 id="RDD创建"><a href="#RDD创建" class="headerlink" title="RDD创建"></a>RDD创建</h2><h3 id="从已有集合创建"><a href="#从已有集合创建" class="headerlink" title="从已有集合创建"></a>从已有集合创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc.parallelize([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<h3 id="从外部数据集创建"><a href="#从外部数据集创建" class="headerlink" title="从外部数据集创建"></a>从外部数据集创建</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">本地文件系统</span></span><br><span class="line">sc.textFile(&#x27;file:///home/zhangsan/bigdata.txt&#x27;).collect()</span><br><span class="line">[&#x27;www&#x27;, &#x27;www studybigdata &#x27;, &#x27;www studybigdata cn&#x27;]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">HDFS</span></span><br><span class="line">sc.textFile(&#x27;hdfs://node0:9000/user/zhangsan/bigdata.txt&#x27;).collect()</span><br><span class="line">[&#x27;www&#x27;, &#x27;www studybigdata &#x27;, &#x27;www studybigdata cn&#x27;]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">其他数据源 SequenceFiles, HBase ... ...</span></span><br></pre></td></tr></table></figure>

<h2 id="RDD-1"><a href="#RDD-1" class="headerlink" title="RDD"></a>RDD</h2><h3 id="转换算子"><a href="#转换算子" class="headerlink" title="转换算子"></a>转换算子</h3><p>先看一下去重、条件查询、排序，使用的RDD为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize([<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<h5 id="distinct-去重"><a href="#distinct-去重" class="headerlink" title="distinct (去重)"></a>distinct (去重)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>distinct_rdd = rdd.distinct()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>distinct_rdd.collect()</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<h5 id="filter-条件查询-x2F-过滤"><a href="#filter-条件查询-x2F-过滤" class="headerlink" title="filter  (条件查询&#x2F;过滤)"></a>filter  (条件查询&#x2F;过滤)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>filter_rdd = rdd.<span class="built_in">filter</span>(<span class="keyword">lambda</span> x:x!=<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>filter_rdd.collect()</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h5 id="sortBy-排序"><a href="#sortBy-排序" class="headerlink" title="sortBy (排序)"></a>sortBy (排序)</h5><ul>
<li>升序</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sort_rdd = rdd.sortBy(<span class="keyword">lambda</span> x:x)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sort_rdd.collect()</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>降序</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sort_rdd = rdd.sortBy(<span class="keyword">lambda</span> x:-x)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sort_rdd.collect()</span><br><span class="line">[<span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>根据元素长度排序</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = [(<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>),(<span class="number">2</span>,),(<span class="number">1</span>,<span class="number">1</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize(data)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sort_by_len_rdd = rdd.sortBy(<span class="keyword">lambda</span> x: <span class="built_in">len</span>(x))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sort_by_len_rdd.collect()</span><br><span class="line">[(<span class="number">2</span>,), (<span class="number">1</span>, <span class="number">1</span>), (<span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>)]</span><br></pre></td></tr></table></figure>

<ul>
<li>根据索引排序</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用上一步骤中的RDD</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sort_by_index = rdd.sortBy(<span class="keyword">lambda</span> x:x[<span class="number">0</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sort_by_index.collect()</span><br><span class="line">[(<span class="number">1</span>, <span class="number">1</span>), (<span class="number">2</span>,), (<span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>)]</span><br></pre></td></tr></table></figure>





<p>接下来演示一下RDD的交、并、差、笛卡尔积运算，使用的RDD为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd_1 = sc.parallelize([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd_2 = sc.parallelize([<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br></pre></td></tr></table></figure>

<h5 id="intersection-交集"><a href="#intersection-交集" class="headerlink" title="intersection (交集)"></a>intersection (交集)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>intersection_rdd = rdd_1.intersection(rdd_2)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>intersection_rdd.collect()</span><br></pre></td></tr></table></figure>

<h5 id="union-并集"><a href="#union-并集" class="headerlink" title="union (并集)"></a>union (并集)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>union_rdd = rdd_1.union(rdd_2)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>union_rdd.collect()</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<h5 id="subtract-差集"><a href="#subtract-差集" class="headerlink" title="subtract (差集)"></a>subtract (差集)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>substract_rdd = rdd_1.subtract(rdd_2)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>substract_rdd.collect()</span><br><span class="line">[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<h5 id="cartesian-笛卡尔积"><a href="#cartesian-笛卡尔积" class="headerlink" title="cartesian (笛卡尔积)"></a>cartesian (笛卡尔积)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>cartesian_rdd = rdd_1.cartesian(rdd_2)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>cartesian_rdd.collect()</span><br><span class="line">[(<span class="number">1</span>, <span class="number">2</span>), (<span class="number">1</span>, <span class="number">3</span>), (<span class="number">1</span>, <span class="number">4</span>), (<span class="number">2</span>, <span class="number">2</span>), (<span class="number">2</span>, <span class="number">3</span>), (<span class="number">2</span>, <span class="number">4</span>), (<span class="number">3</span>, <span class="number">2</span>), (<span class="number">3</span>, <span class="number">3</span>), (<span class="number">3</span>, <span class="number">4</span>)]</span><br></pre></td></tr></table></figure>



<p>下面是与分区相关的算子，使用的RDD为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">20</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_rdd = sc.parallelize(nums)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_rdd.collect()</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>]</span><br></pre></td></tr></table></figure>

<h5 id="glom"><a href="#glom" class="headerlink" title="glom"></a><a href="#glom">glom</a></h5><p>联合所有分区元素构造一个列表。 </p>
<p>Return <code>an RDD</code> created by <code>coalescing</code>  <code>all elements within each partition</code> into a <code>list</code>.</p>
<p>coalesce： <code>[ˌkoʊəˈles]</code> 合并，联合</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认8个分区，因为我使用的local模式，只有一个Executor，此Executor中有8个核。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_rdd.glom().collect()</span><br><span class="line">[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>], [<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>], [<span class="number">11</span>, <span class="number">12</span>], [<span class="number">13</span>, <span class="number">14</span>], [<span class="number">15</span>, <span class="number">16</span>], [<span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>]]</span><br></pre></td></tr></table></figure>

<h5 id="repartition"><a href="#repartition" class="headerlink" title="repartition"></a><a href="#repartition">repartition</a></h5><p>返回一个重新分区后的RDD</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>new_num_rdd = num_rdd.repartition(<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>new_num_rdd.glom().collect()</span><br><span class="line">[[], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>], [<span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]]</span><br></pre></td></tr></table></figure>

<p><a href="#getNumPartitions">查看分区数</a></p>
<h5 id="map-映射"><a href="#map-映射" class="headerlink" title="map (映射)"></a>map (映射)</h5><p>item &#x3D;&gt; item_new</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">addOne</span>(<span class="params">item</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">return</span> item+<span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_add_one_rdd = num_rdd.<span class="built_in">map</span>(addOne)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_add_one_rdd.glom().collect()</span><br><span class="line">[[<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>], [<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>], [<span class="number">12</span>, <span class="number">13</span>], [<span class="number">14</span>, <span class="number">15</span>], [<span class="number">16</span>, <span class="number">17</span>], [<span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>]]</span><br></pre></td></tr></table></figure>

<h5 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h5><p>首先将函数应用于此RDD的所有元素，然后将结果展平，返回一个新的RDD。</p>
<p><code>Return a new RDD by first applying a function to all elements of this RDD, and then flattening the results.</code></p>
<ul>
<li>示例一</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = [(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>),(<span class="number">1</span>,<span class="number">2</span>),(<span class="number">3</span>,)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize(data)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd.flatMap(<span class="keyword">lambda</span> x: x).collect()</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<ol start="0">
<li><p>此rdd中有三个元素  [(1,2,3),    (1,2),    (3,)]</p>
</li>
<li><p>先应用函数<code>(lambda x : x)</code>对每个元素进行处理</p>
<p> (1,2,3) —&gt; (1,2,3)<br> (1,2) —&gt; (1,2)<br> (3,) —&gt; (3,)</p>
</li>
<li><p>最后将结果拍扁展平，二维数组压扁成一维列表<br> [(1,2,3),(1,2),(3,)]  &#x3D;&#x3D;&#x3D;&gt; [1, 2, 3, 1, 2, 3]</p>
</li>
</ol>
<ul>
<li>示例二</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = [<span class="string">&#x27;study big data cn&#x27;</span>,<span class="string">&#x27;study big data&#x27;</span>,<span class="string">&#x27;big data&#x27;</span>, <span class="string">&#x27;study&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize(data)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flat_map_rdd = rdd.flatMap(<span class="keyword">lambda</span> item : item.split(<span class="string">&#x27; &#x27;</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flat_map_rdd.collect()</span><br><span class="line">[<span class="string">&#x27;study&#x27;</span>, <span class="string">&#x27;big&#x27;</span>, <span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;cn&#x27;</span>, <span class="string">&#x27;study&#x27;</span>, <span class="string">&#x27;big&#x27;</span>, <span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;big&#x27;</span>, <span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;study&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>首先使用匿名函数，将字符串<code>&quot;study big data cn&quot;</code>拆分成字符串列表<code>[&#39;study&#39;, &#39;big&#39;, &#39;data&#39;, &#39;cn&#39;]</code>；</p>
<p>然后<code>flatMap</code>压扁。</p>
<h5 id="mapPartitions"><a href="#mapPartitions" class="headerlink" title="mapPartitions"></a>mapPartitions</h5><h5 id="mapPartitionsWithIndex"><a href="#mapPartitionsWithIndex" class="headerlink" title="mapPartitionsWithIndex"></a>mapPartitionsWithIndex</h5><h5 id="partitionBy"><a href="#partitionBy" class="headerlink" title="partitionBy"></a>partitionBy</h5><h3 id="动作算子"><a href="#动作算子" class="headerlink" title="动作算子"></a>动作算子</h3><h5 id="isEmpty"><a href="#isEmpty" class="headerlink" title="isEmpty"></a>isEmpty</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd.isEmpty()</span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h5 id="collect"><a href="#collect" class="headerlink" title="collect"></a>collect</h5><p>返回一个包含此RDD中所有元素的<code>list</code>列表。</p>
<p><strong>注意</strong>：由于所有数据都会加载到<code>Driver</code>的内存中，因此仅当生成的<code>列表</code>预计很小时才应使用此方法，数据过大的话，Driver内存放不下。</p>
<p><code>Return a list that contains all of the elements in this RDD. note: This method should only be used if the resulting array is expected to be small, as all the data is loaded into the driver&#39;s memory. </code></p>
<h5 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h5><p>使用指定的交换和结合二元操作符<code>reduce</code>此RDD的元素。<code>reduces partitions locally.</code>。</p>
<p>比如加减乘除等二元操作符。</p>
<p><code>Reduces the elements of this RDD using the specified commutative and associative binary operator. Currently reduces partitions locally.</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd.reduce(<span class="keyword">lambda</span> x,y:x+y)</span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure>

<h5 id="count"><a href="#count" class="headerlink" title="count"></a>count</h5><p>返回此RDD中的元素个数。</p>
<p><code>Return the number of elements in this RDD.</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize([<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd.count()</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>

<h5 id="take"><a href="#take" class="headerlink" title="take"></a>take</h5><p>获取RDD的前<code>n</code>个元素。</p>
<p><code>Take the first num elements of the RDD.</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize([<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd.take(<span class="number">2</span>)</span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<h5 id="takeOrdered"><a href="#takeOrdered" class="headerlink" title="takeOrdered"></a>takeOrdered</h5><p>从RDD中按升序或可选键函数指定的顺序获取N个元素。</p>
<p><code>Get the N elements from an RDD ordered in ascending order or as specified by the optional key function.</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rdd中的元素本来是[2,1,3]</span></span><br><span class="line"><span class="comment"># 升序排列，输出前两个元素</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd.takeOrdered(<span class="number">2</span>)</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h5 id="first"><a href="#first" class="headerlink" title="first"></a>first</h5><p>返回此RDD中的第一个元素。</p>
<p><code>Return the first element in this RDD.</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rdd = [2,1,3]</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd.first()</span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>

<h5 id="top"><a href="#top" class="headerlink" title="top"></a>top</h5><p>从RDD中获取前N个元素。</p>
<p><code>Get the top N elements from an RDD.</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rdd = [2,1,3]</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd.top(<span class="number">2</span>)</span><br><span class="line">[<span class="number">3</span>, <span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h5 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h5><p>将函数应用到此RDD的所有元素。</p>
<p><code>Applies a function to all elements of this RDD.</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每个元素的值+1 （执行完控制台无任何输出）</span></span><br><span class="line">sc.parallelize([<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>]).foreach(<span class="keyword">lambda</span> x: x+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可借助print()打印处理后的结果</span></span><br><span class="line"><span class="comment"># 第一次输出</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sc.parallelize([<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>]).foreach(<span class="keyword">lambda</span> x: <span class="built_in">print</span>(x+<span class="number">1</span>))</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="comment"># 第二次输出（可以看到元素的遍历顺序是无序的）</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sc.parallelize([<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>]).foreach(<span class="keyword">lambda</span> x: <span class="built_in">print</span>(x+<span class="number">1</span>))</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>

<h5 id="getNumPartitions"><a href="#getNumPartitions" class="headerlink" title="getNumPartitions"></a><a href="#getNumPartitions">getNumPartitions</a></h5><p><code>Returns the number of partitions in RDD</code></p>
<p>返回RDD的分区数。</p>
<p>小编的机器为4核心8线程，<code>PySpark</code>通过<code>Local</code>模式启动，所以你可以看到数据分区数默认为机器逻辑CPU的个数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成19个数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">20</span>)) </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造RDD</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_rdd = sc.parallelize(nums)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据分区数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_rdd.getNumPartitions()</span><br><span class="line"><span class="number">8</span></span><br></pre></td></tr></table></figure>

<h5 id="foreachPartition"><a href="#foreachPartition" class="headerlink" title="foreachPartition"></a>foreachPartition</h5><p>将函数应用到此RDD的所有分区。</p>
<p><code>Applies a function to each partition of this RDD.</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用上一步的数据</span></span><br><span class="line"><span class="comment"># 统计一下每个分区内的元素个数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据分布情况</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_rdd.glom().collect()</span><br><span class="line">[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>], [<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>], [<span class="number">11</span>, <span class="number">12</span>], [<span class="number">13</span>, <span class="number">14</span>], [<span class="number">15</span>, <span class="number">16</span>], [<span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计一下每个分区内的元素个数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>each_part_size = num_rdd.foreachPartition(<span class="keyword">lambda</span> part: <span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">list</span>(part))))</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>

<h5 id="saveAsTextFile"><a href="#saveAsTextFile" class="headerlink" title="saveAsTextFile"></a>saveAsTextFile</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用上一步数据</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_rdd.saveAsTextFile(<span class="string">&quot;file:///home/quqingyuan/num&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 去本地文件系统查看一下保存结果，每个分区的数据保存为一个文件</span></span><br><span class="line">(python37) [quqingyuan@honor num]$ ll</span><br><span class="line">total 32K</span><br><span class="line">-rw-r--r-- <span class="number">1</span> quqingyuan quqingyuan <span class="number">4</span> Jul  <span class="number">8</span> <span class="number">12</span>:<span class="number">46</span> part-<span class="number">00000</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> quqingyuan quqingyuan <span class="number">4</span> Jul  <span class="number">8</span> <span class="number">12</span>:<span class="number">46</span> part-00001</span><br><span class="line">-rw-r--r-- <span class="number">1</span> quqingyuan quqingyuan <span class="number">4</span> Jul  <span class="number">8</span> <span class="number">12</span>:<span class="number">46</span> part-00002</span><br><span class="line">-rw-r--r-- <span class="number">1</span> quqingyuan quqingyuan <span class="number">9</span> Jul  <span class="number">8</span> <span class="number">12</span>:<span class="number">46</span> part-00003</span><br><span class="line">-rw-r--r-- <span class="number">1</span> quqingyuan quqingyuan <span class="number">6</span> Jul  <span class="number">8</span> <span class="number">12</span>:<span class="number">46</span> part-00004</span><br><span class="line">-rw-r--r-- <span class="number">1</span> quqingyuan quqingyuan <span class="number">6</span> Jul  <span class="number">8</span> <span class="number">12</span>:<span class="number">46</span> part-00005</span><br><span class="line">-rw-r--r-- <span class="number">1</span> quqingyuan quqingyuan <span class="number">6</span> Jul  <span class="number">8</span> <span class="number">12</span>:<span class="number">46</span> part-00006</span><br><span class="line">-rw-r--r-- <span class="number">1</span> quqingyuan quqingyuan <span class="number">9</span> Jul  <span class="number">8</span> <span class="number">12</span>:<span class="number">46</span> part-00007</span><br><span class="line">-rw-r--r-- <span class="number">1</span> quqingyuan quqingyuan <span class="number">0</span> Jul  <span class="number">8</span> <span class="number">12</span>:<span class="number">46</span> _SUCCESS</span><br></pre></td></tr></table></figure>

<p>如果一个RDD里面只有三个元素，会保存为几个文件？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>three_rdd = sc.parallelize([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>three_rdd.saveAsTextFile(<span class="string">&quot;file:///home/quqingyuan/three&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看保存结果</span></span><br><span class="line">(python37) [quqingyuan@honor three]$ cat part-<span class="number">00000</span></span><br><span class="line">(python37) [quqingyuan@honor three]$ cat part-00001</span><br><span class="line">(python37) [quqingyuan@honor three]$ cat part-00002</span><br><span class="line"><span class="number">1</span></span><br><span class="line">(python37) [quqingyuan@honor three]$ cat part-00003</span><br><span class="line">(python37) [quqingyuan@honor three]$ cat part-00004</span><br><span class="line">(python37) [quqingyuan@honor three]$ cat part-00005</span><br><span class="line"><span class="number">2</span></span><br><span class="line">(python37) [quqingyuan@honor three]$ cat part-00006</span><br><span class="line">(python37) [quqingyuan@honor three]$ cat part-00007</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>



<h2 id="键值对RDD"><a href="#键值对RDD" class="headerlink" title="键值对RDD"></a>键值对RDD</h2><h3 id="转换算子-1"><a href="#转换算子-1" class="headerlink" title="转换算子"></a>转换算子</h3><h4 id="keys"><a href="#keys" class="headerlink" title="keys"></a>keys</h4><h4 id="values"><a href="#values" class="headerlink" title="values"></a>values</h4><h4 id="mapValues"><a href="#mapValues" class="headerlink" title="mapValues"></a>mapValues</h4><h4 id="flatMapValues"><a href="#flatMapValues" class="headerlink" title="flatMapValues"></a>flatMapValues</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">flatMapValues</span>(<span class="params">self, f</span>):</span><br><span class="line">	flat_map_fn = <span class="keyword">lambda</span> kv: ((kv[<span class="number">0</span>], x) <span class="keyword">for</span> x <span class="keyword">in</span> f(kv[<span class="number">1</span>]))</span><br><span class="line">	<span class="keyword">return</span> self.flatMap(flat_map_fn, preservesPartitioning=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>


<h4 id="sortByKey"><a href="#sortByKey" class="headerlink" title="sortByKey"></a>sortByKey</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sc.parallelize(rdd).sortByKey().collect()</span><br><span class="line">[(<span class="number">1</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="number">2</span>, <span class="string">&#x27;a&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;ab&#x27;</span>)]</span><br></pre></td></tr></table></figure>

<h4 id="groupByKey"><a href="#groupByKey" class="headerlink" title="groupByKey"></a>groupByKey</h4><h4 id="subtractByKey"><a href="#subtractByKey" class="headerlink" title="subtractByKey"></a>subtractByKey</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rdd1 = sc.parallelize(([<span class="string">&#x27;a&#x27;</span>, <span class="number">3</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>], [<span class="string">&#x27;c&#x27;</span>, <span class="number">5</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="number">3</span>]))</span><br><span class="line">rdd2 = sc.parallelize(([<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>], [<span class="string">&#x27;c&#x27;</span>, <span class="number">2</span>]))</span><br><span class="line">rdd3 = rdd1.groupByKey().subtractByKey(rdd2).mapValues(<span class="built_in">list</span>)</span><br><span class="line"><span class="built_in">print</span>(rdd3.collect())</span><br><span class="line"></span><br><span class="line"><span class="comment"># result</span></span><br><span class="line">[(<span class="string">&#x27;b&#x27;</span>, [<span class="number">2</span>, <span class="number">3</span>])]</span><br></pre></td></tr></table></figure>

<h4 id="reduceByKey"><a href="#reduceByKey" class="headerlink" title="reduceByKey"></a>reduceByKey</h4><h4 id="combineByKey"><a href="#combineByKey" class="headerlink" title="combineByKey"></a>combineByKey</h4><h4 id="join"><a href="#join" class="headerlink" title="join"></a>join</h4><h4 id="leftOuterJoin"><a href="#leftOuterJoin" class="headerlink" title="leftOuterJoin"></a>leftOuterJoin</h4><h4 id="rightOuterJoin"><a href="#rightOuterJoin" class="headerlink" title="rightOuterJoin"></a>rightOuterJoin</h4><h3 id="动作算子-1"><a href="#动作算子-1" class="headerlink" title="动作算子"></a>动作算子</h3><h4 id="CollectAsMap"><a href="#CollectAsMap" class="headerlink" title="CollectAsMap"></a>CollectAsMap</h4><h4 id="countByKey"><a href="#countByKey" class="headerlink" title="countByKey"></a>countByKey</h4><h4 id="countByValue"><a href="#countByValue" class="headerlink" title="countByValue"></a>countByValue</h4><h2 id="DoubleRDDFunctions"><a href="#DoubleRDDFunctions" class="headerlink" title="DoubleRDDFunctions"></a>DoubleRDDFunctions</h2><h4 id="max"><a href="#max" class="headerlink" title="max"></a>max</h4><h4 id="min"><a href="#min" class="headerlink" title="min"></a>min</h4><h4 id="sum"><a href="#sum" class="headerlink" title="sum"></a>sum</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sc.parallelize([<span class="number">1.0</span>,<span class="number">2.0</span>,<span class="number">3.0</span>]).<span class="built_in">sum</span>()</span><br><span class="line"><span class="number">6.0</span></span><br></pre></td></tr></table></figure>

<h4 id="stats"><a href="#stats" class="headerlink" title="stats"></a>stats</h4><h4 id="mean"><a href="#mean" class="headerlink" title="mean"></a>mean</h4><h2 id="SequenceFileRDDFunctions"><a href="#SequenceFileRDDFunctions" class="headerlink" title="SequenceFileRDDFunctions"></a>SequenceFileRDDFunctions</h2><h4 id="saveAsSequenceFile"><a href="#saveAsSequenceFile" class="headerlink" title="saveAsSequenceFile"></a>saveAsSequenceFile</h4><h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><h4 id="分区练习"><a href="#分区练习" class="headerlink" title="分区练习"></a>分区练习</h4><p>初始化列表 <code>list_p = [1,2,3,4,5]</code></p>
<p>使用<code>list_p</code>创建分区数为<code>2</code>的<code>RDD</code> ，命名为<code>rdd_p</code></p>
<p>查看<code>rdd_p</code>的分区数</p>
<p>查看<code>rdd_p</code>各分区内的元素</p>
<p>使用<code>rdd_p</code>创建一个分区数为<code>3</code>的<code>RDD</code>，命名为<code>rdd_rp</code></p>
<p>查看<code>rdd_rp</code>各分区内的元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>list_p=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd_p=sc.parallelize(list_p,<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd_p.getNumPartitions()</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd_p.glom().collect()</span><br><span class="line">[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd_rp=rdd_p.repartition(<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd_rp.glom().collect()</span><br><span class="line">[[], [<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]]</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">XiaoQu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://www.studybigdata.cn/Spark/PySpark/Spark_Python_Rdd/">http://www.studybigdata.cn/Spark/PySpark/Spark_Python_Rdd/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Spark/PySpark/Spark_Python_QA/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Spark Python QA</div></div></a></div><div class="next-post pull-right"><a href="/Spark/PySpark/Spark_Python_Streaming/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">PySpark Streaming</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/jin.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">XiaoQu</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">78</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">39</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">23</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/A-stranger"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RDD"><span class="toc-number">1.</span> <span class="toc-text">RDD</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RDD%E5%88%9B%E5%BB%BA"><span class="toc-number">1.1.</span> <span class="toc-text">RDD创建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E5%B7%B2%E6%9C%89%E9%9B%86%E5%90%88%E5%88%9B%E5%BB%BA"><span class="toc-number">1.1.1.</span> <span class="toc-text">从已有集合创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E5%A4%96%E9%83%A8%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%9B%E5%BB%BA"><span class="toc-number">1.1.2.</span> <span class="toc-text">从外部数据集创建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RDD-1"><span class="toc-number">1.2.</span> <span class="toc-text">RDD</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2%E7%AE%97%E5%AD%90"><span class="toc-number">1.2.1.</span> <span class="toc-text">转换算子</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#distinct-%E5%8E%BB%E9%87%8D"><span class="toc-number">1.2.1.0.1.</span> <span class="toc-text">distinct (去重)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#filter-%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2-x2F-%E8%BF%87%E6%BB%A4"><span class="toc-number">1.2.1.0.2.</span> <span class="toc-text">filter  (条件查询&#x2F;过滤)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#sortBy-%E6%8E%92%E5%BA%8F"><span class="toc-number">1.2.1.0.3.</span> <span class="toc-text">sortBy (排序)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#intersection-%E4%BA%A4%E9%9B%86"><span class="toc-number">1.2.1.0.4.</span> <span class="toc-text">intersection (交集)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#union-%E5%B9%B6%E9%9B%86"><span class="toc-number">1.2.1.0.5.</span> <span class="toc-text">union (并集)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#subtract-%E5%B7%AE%E9%9B%86"><span class="toc-number">1.2.1.0.6.</span> <span class="toc-text">subtract (差集)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#cartesian-%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF"><span class="toc-number">1.2.1.0.7.</span> <span class="toc-text">cartesian (笛卡尔积)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#glom"><span class="toc-number">1.2.1.0.8.</span> <span class="toc-text">glom</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#repartition"><span class="toc-number">1.2.1.0.9.</span> <span class="toc-text">repartition</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#map-%E6%98%A0%E5%B0%84"><span class="toc-number">1.2.1.0.10.</span> <span class="toc-text">map (映射)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#flatMap"><span class="toc-number">1.2.1.0.11.</span> <span class="toc-text">flatMap</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#mapPartitions"><span class="toc-number">1.2.1.0.12.</span> <span class="toc-text">mapPartitions</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#mapPartitionsWithIndex"><span class="toc-number">1.2.1.0.13.</span> <span class="toc-text">mapPartitionsWithIndex</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#partitionBy"><span class="toc-number">1.2.1.0.14.</span> <span class="toc-text">partitionBy</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E4%BD%9C%E7%AE%97%E5%AD%90"><span class="toc-number">1.2.2.</span> <span class="toc-text">动作算子</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#isEmpty"><span class="toc-number">1.2.2.0.1.</span> <span class="toc-text">isEmpty</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#collect"><span class="toc-number">1.2.2.0.2.</span> <span class="toc-text">collect</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#reduce"><span class="toc-number">1.2.2.0.3.</span> <span class="toc-text">reduce</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#count"><span class="toc-number">1.2.2.0.4.</span> <span class="toc-text">count</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#take"><span class="toc-number">1.2.2.0.5.</span> <span class="toc-text">take</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#takeOrdered"><span class="toc-number">1.2.2.0.6.</span> <span class="toc-text">takeOrdered</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#first"><span class="toc-number">1.2.2.0.7.</span> <span class="toc-text">first</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#top"><span class="toc-number">1.2.2.0.8.</span> <span class="toc-text">top</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#foreach"><span class="toc-number">1.2.2.0.9.</span> <span class="toc-text">foreach</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#getNumPartitions"><span class="toc-number">1.2.2.0.10.</span> <span class="toc-text">getNumPartitions</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#foreachPartition"><span class="toc-number">1.2.2.0.11.</span> <span class="toc-text">foreachPartition</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#saveAsTextFile"><span class="toc-number">1.2.2.0.12.</span> <span class="toc-text">saveAsTextFile</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%AE%E5%80%BC%E5%AF%B9RDD"><span class="toc-number">1.3.</span> <span class="toc-text">键值对RDD</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2%E7%AE%97%E5%AD%90-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">转换算子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#keys"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">keys</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#values"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">values</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mapValues"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">mapValues</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flatMapValues"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">flatMapValues</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sortByKey"><span class="toc-number">1.3.1.5.</span> <span class="toc-text">sortByKey</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#groupByKey"><span class="toc-number">1.3.1.6.</span> <span class="toc-text">groupByKey</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#subtractByKey"><span class="toc-number">1.3.1.7.</span> <span class="toc-text">subtractByKey</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#reduceByKey"><span class="toc-number">1.3.1.8.</span> <span class="toc-text">reduceByKey</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#combineByKey"><span class="toc-number">1.3.1.9.</span> <span class="toc-text">combineByKey</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#join"><span class="toc-number">1.3.1.10.</span> <span class="toc-text">join</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#leftOuterJoin"><span class="toc-number">1.3.1.11.</span> <span class="toc-text">leftOuterJoin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rightOuterJoin"><span class="toc-number">1.3.1.12.</span> <span class="toc-text">rightOuterJoin</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E4%BD%9C%E7%AE%97%E5%AD%90-1"><span class="toc-number">1.3.2.</span> <span class="toc-text">动作算子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CollectAsMap"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">CollectAsMap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#countByKey"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">countByKey</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#countByValue"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">countByValue</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DoubleRDDFunctions"><span class="toc-number">1.4.</span> <span class="toc-text">DoubleRDDFunctions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#max"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">max</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#min"><span class="toc-number">1.4.0.2.</span> <span class="toc-text">min</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sum"><span class="toc-number">1.4.0.3.</span> <span class="toc-text">sum</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#stats"><span class="toc-number">1.4.0.4.</span> <span class="toc-text">stats</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mean"><span class="toc-number">1.4.0.5.</span> <span class="toc-text">mean</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SequenceFileRDDFunctions"><span class="toc-number">1.5.</span> <span class="toc-text">SequenceFileRDDFunctions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#saveAsSequenceFile"><span class="toc-number">1.5.0.1.</span> <span class="toc-text">saveAsSequenceFile</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">1.6.</span> <span class="toc-text">练习</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E7%BB%83%E4%B9%A0"><span class="toc-number">1.6.0.1.</span> <span class="toc-text">分区练习</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/JavaEE/MyEclipse/" title="MyEclipse激活与JavaEE项目创建">MyEclipse激活与JavaEE项目创建</a><time datetime="2023-05-09T11:05:00.000Z" title="Created 2023-05-09 19:05:00">2023-05-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/JavaEE/JSP/" title="Java Server Page(JSP)">Java Server Page(JSP)</a><time datetime="2023-05-07T09:03:00.000Z" title="Created 2023-05-07 17:03:00">2023-05-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/JavaEE/%E5%9F%BA%E4%BA%8EJSP%E7%9A%84%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/" title="基于JSP的学生信息管理系统">基于JSP的学生信息管理系统</a><time datetime="2023-05-07T09:03:00.000Z" title="Created 2023-05-07 17:03:00">2023-05-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/MIIT/MIIT/" title="工信部职业技术认证资格考试">工信部职业技术认证资格考试</a><time datetime="2023-03-21T14:14:00.000Z" title="Created 2023-03-21 22:14:00">2023-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/JavaEE/2-5%20JavaScript%E5%85%A5%E9%97%A8/" title="【实训2-5】JavaScript 入门">【实训2-5】JavaScript 入门</a><time datetime="2023-03-21T10:14:00.000Z" title="Created 2023-03-21 18:14:00">2023-03-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By XiaoQu</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>