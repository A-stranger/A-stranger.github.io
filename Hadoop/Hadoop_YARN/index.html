<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Hadoop_YARN | 学习大数据</title><meta name="keywords" content="Hadoop,YARN"><meta name="author" content="XiaoQu"><meta name="copyright" content="XiaoQu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="YARN概览  HDFS在两个版本中都存在；  MapReduce是Hadoop v1中唯一的Execution Engine；  YARN框架提供的Work Scheduling与正在执行的Work类型无关；  Hadoop v2上的所有的Execution Engine都作为YARN应用程序实现。  Hadoop v2支持任何Execution Engine，包括MapReduce的端口，该端">
<meta property="og:type" content="article">
<meta property="og:title" content="Hadoop_YARN">
<meta property="og:url" content="http://www.studybigdata.cn/Hadoop/Hadoop_YARN/index.html">
<meta property="og:site_name" content="学习大数据">
<meta property="og:description" content="YARN概览  HDFS在两个版本中都存在；  MapReduce是Hadoop v1中唯一的Execution Engine；  YARN框架提供的Work Scheduling与正在执行的Work类型无关；  Hadoop v2上的所有的Execution Engine都作为YARN应用程序实现。  Hadoop v2支持任何Execution Engine，包括MapReduce的端口，该端">
<meta property="og:locale">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2021-01-15T07:55:26.000Z">
<meta property="article:modified_time" content="2023-01-15T11:12:01.144Z">
<meta property="article:author" content="XiaoQu">
<meta property="article:tag" content="Hadoop">
<meta property="article:tag" content="YARN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.studybigdata.cn/Hadoop/Hadoop_YARN/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="code-qvYtDCUlcS"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?057fccfc2b1bef4c0d79224d80660be0";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hadoop_YARN',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-01-15 19:12:01'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/jin.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">89</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">50</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">23</div></a></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">学习大数据</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Hadoop_YARN</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-01-15T07:55:26.000Z" title="Created 2021-01-15 15:55:26">2021-01-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-01-15T11:12:01.144Z" title="Updated 2023-01-15 19:12:01">2023-01-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Hadoop/">Hadoop</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Hadoop_YARN"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><h2 id="YARN概览"><a href="#YARN概览" class="headerlink" title="YARN概览"></a>YARN概览</h2><p><img src="/img/Hadoop_YARN/image-20221005190448437.png" alt="image-20221005190448437"></p>
<ul>
<li><p><code>HDFS</code>在两个版本中都存在；</p>
</li>
<li><p><code>MapReduce</code>是<code>Hadoop v1</code>中唯一的<code>Execution Engine</code>；</p>
</li>
<li><p><code>YARN</code>框架提供的<code>Work Scheduling</code>与正在执行的<code>Work</code>类型无关；</p>
</li>
<li><p><code>Hadoop v2</code>上的所有的<code>Execution Engine</code>都作为<code>YARN</code>应用程序实现。</p>
</li>
<li><p><code>Hadoop v2</code>支持任何<code>Execution Engine</code>，包括<code>MapReduce</code>的端口，该端口现在是一个<code>YARN</code>应用程序。</p>
</li>
</ul>
<h3 id="为什么选择YARN"><a href="#为什么选择YARN" class="headerlink" title="为什么选择YARN"></a>为什么选择YARN</h3><ol>
<li><code>MapReduce</code>是<code>batch-based</code>，不适合 <code>real-time</code>,  <code>near-real-time</code>, <code>Graph</code>,  <code>Iterative</code>数据处理；</li>
<li><code>Hadoop v1</code>限制了运行其他框架，<code>YARN</code>使<code>MapReduce</code>以外的工作也能够在<code>Hadoop</code>集群上执行；</li>
<li><code>Hadoop v1</code> 的<code>JobTracker</code>存在并发问题，一个<code>Hadoop Cluster</code>的限制在<code>3000-4000</code>个节点。</li>
<li><code>YARN</code>的目标是能够扩展到<code>10000</code>个节点；</li>
<li><code>YARN</code>允许在同一个集群中同时运行不同版本的<code>MapReduce</code>；</li>
</ol>
<h5 id="YARN是一个分布式调度器，负责以下两个活动："><a href="#YARN是一个分布式调度器，负责以下两个活动：" class="headerlink" title="YARN是一个分布式调度器，负责以下两个活动："></a>YARN是一个分布式调度器，负责以下两个活动：</h5><ol>
<li>响应<code>Client</code>申请<code>Container</code>的请求，<code>Container</code>实质上是一个<code>process</code>，能对指定的物理资源进行管理。</li>
<li>监视正在运行的<code>Container</code>，并在需要时终止<code>Container</code>。<ul>
<li>释放<code>Container</code>以便其他<code>Application</code>的<code>Container</code>可以运行；</li>
<li><code>Container</code>使用的资源超出<code>Allocated</code>的资源。</li>
</ul>
</li>
</ol>
<h3 id="YARN概念和组件"><a href="#YARN概念和组件" class="headerlink" title="YARN概念和组件"></a>YARN概念和组件</h3><h4 id="YARN组件及其相互作用"><a href="#YARN组件及其相互作用" class="headerlink" title="YARN组件及其相互作用"></a>YARN组件及其相互作用</h4><p><img src="/img/Hadoop_YARN/image-20221005190629313.png" alt="YARN组件及其相互作用"></p>
<h5 id="ResourceManager"><a href="#ResourceManager" class="headerlink" title="ResourceManager"></a>ResourceManager</h5><ul>
<li>调度器<code>Schedule(YarnScheduler)</code>：响应客户端创建<code>Container</code>的请求，<code>Container</code>的创建实际上委托给了<code>NodeManager</code></li>
<li>应用程序管理器<code>ApplicationManager(RMAppManager)</code>： manages the list of applications。</li>
</ul>
<h5 id="NodeManager"><a href="#NodeManager" class="headerlink" title="NodeManager"></a>NodeManager</h5><ul>
<li>接收<code>ResourceManager</code>指令创建、监视、终止<code>Container</code></li>
<li>向<code>ResourceManager</code>报告<code>Container</code>状态</li>
</ul>
<h4 id="典型的YARN应用程序"><a href="#典型的YARN应用程序" class="headerlink" title="典型的YARN应用程序"></a>典型的YARN应用程序</h4><p><img src="/img/Hadoop_YARN/image-20221005190700341.png" alt="image-20221005190700341"></p>
<h5 id="ApplicationManager"><a href="#ApplicationManager" class="headerlink" title="ApplicationManager"></a>ApplicationManager</h5><ul>
<li><p>向<code>ResourceManager</code>申请资源<code>Container</code></p>
</li>
<li><p>监控<code>Application</code>状态，失败重启<code>Application</code></p>
</li>
</ul>
<h4 id="单节点内的container"><a href="#单节点内的container" class="headerlink" title="单节点内的container"></a>单节点内的container</h4><p><img src="/img/Hadoop_YARN/image-20221005191051220.png" alt="image-20221005191051220"></p>
<ul>
<li>客户端指定每个<code>Container</code>的<code>CPU</code>和<code>内存</code>要求，再加上没有预定的进程分配，这意味着与<code>MapReduce</code>调度程序相比，<code>YARN</code>对节点的利用率的控制要好得多；</li>
<li>每个<code>Container</code>创建时都考虑到具体的<code>CPU</code>和<code>内存</code>占用（由<code>ApplicationMaster</code>指定）</li>
<li>一个<code>NodeManager</code>中有一个<code>Container Pool</code>，该<code>Pool</code>内可以启动多个不同大小的<code>Container</code></li>
<li><code>Container</code>进程可以是 <code>Linux</code>命令、<code>Python</code>应用程序、其他可由操作系统启动的任何进程；</li>
</ul>
<h3 id="YARN配置"><a href="#YARN配置" class="headerlink" title="YARN配置"></a>YARN配置</h3><p><img src="/img/Hadoop_YARN/image-20221006182825545.png" alt="image-20221006182825545"></p>
<h3 id="与YARN交互"><a href="#与YARN交互" class="headerlink" title="与YARN交互"></a>与YARN交互</h3><h4 id="实验2：在YARN集群中运行一个命令"><a href="#实验2：在YARN集群中运行一个命令" class="headerlink" title="实验2：在YARN集群中运行一个命令"></a>实验2：在YARN集群中运行一个命令</h4><h5 id="问题：您希望在-Hadoop-集群中的节点上运行-Linux-命令。"><a href="#问题：您希望在-Hadoop-集群中的节点上运行-Linux-命令。" class="headerlink" title="问题：您希望在 Hadoop 集群中的节点上运行 Linux 命令。"></a>问题：您希望在 <code>Hadoop</code> 集群中的节点上运行 <code>Linux</code> 命令。</h5><h5 id="解决办法：使用与-Hadoop-捆绑在一起的DistributedShell示例应用程序。"><a href="#解决办法：使用与-Hadoop-捆绑在一起的DistributedShell示例应用程序。" class="headerlink" title="解决办法：使用与 Hadoop 捆绑在一起的DistributedShell示例应用程序。"></a>解决办法：使用与 Hadoop 捆绑在一起的<code>DistributedShell</code>示例应用程序。</h5><h5 id="作用：Start-by-issuing-a-Linux-find-command-in-a-single-container"><a href="#作用：Start-by-issuing-a-Linux-find-command-in-a-single-container" class="headerlink" title="作用：Start by issuing a Linux find command in a single container:"></a>作用：Start by issuing a Linux find command in a single container:</h5><p><img src="/img/Hadoop_YARN/image-20221006183023109.png" alt="image-20221006183023109"></p>
<p><code>DistributedShell ApplicationMaster</code>在分开的<code>Container</code>中启动<code>find</code>命令，您看不到该命令的执行结果，<code>find</code>命令的标准输出（和标准错误输出）将重定向到<code>Container</code>的日志输出目录。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[zhangsan@node1 userlogs]$ yarn org.apache.hadoop.yarn.applications.distributedshell.Client -debug -shell_command find -shell_args &#x27;`pwd`&#x27; --jar $&#123;HADOOP_HOME&#125;/share/hadoop/yarn/*distributedshell-*.jar -container_memory 250 -master_memory 250 -num_containers 5</span><br></pre></td></tr></table></figure>

<p>如果成功执行该命令，您将会看到如下结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INFO distributedshell.Client: Application completed successfully</span><br></pre></td></tr></table></figure>

<h5 id="如何确定Application-ID？"><a href="#如何确定Application-ID？" class="headerlink" title="如何确定Application ID？"></a>如何确定Application ID？</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[zhangsan@node1 ~]$  yarn org.apache.hadoop.yarn.applications.distributedshell.Client -debug -shell_command find -shell_args &#x27;`pwd`&#x27; --jar $&#123;HADOOP_HOME&#125;/share/hadoop/yarn/*distributedshell-*.jar -container_memory 350 -master_memory 350 -num_containers 3</span><br><span class="line">... ...</span><br><span class="line">22/10/06 19:04:26 INFO impl.YarnClientImpl: Submitted application `application_1665053453700_0001`</span><br></pre></td></tr></table></figure>

<p>使用<code>CLI</code>查看日志：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zhangsan@node1 ~]$ yarn logs -applicationId application_1665053453700_0001 </span><br><span class="line">Application has not completed. Logs are only available after an application completes</span><br></pre></td></tr></table></figure>

<p>应用程序完成后，如果尝试再次运行该命令，您可能会看到以下输出：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zhangsan@node1 ~]$ yarn logs -applicationId application_1665053453700_0001</span><br><span class="line">22/10/06 19:05:46 INFO client.RMProxy: Connecting to ResourceManager at node1/192.168.179.101:8032</span><br><span class="line">/tmp/logs/zhangsan/logs/application_1665053453700_0001 does not exist.</span><br><span class="line">Log aggregation has not completed or is not enabled.</span><br></pre></td></tr></table></figure>

<p><code>YARN CLI</code>仅在<code>Application</code>完成并启用了<code>日志聚合</code>时才能使用。</p>
<h5 id="关闭-YARN-Application"><a href="#关闭-YARN-Application" class="headerlink" title="关闭 YARN Application"></a>关闭 YARN Application</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zhangsan@node0 bin]$ yarn application -kill application_1670156642351_0002</span><br><span class="line">22/12/05 01:17:47 INFO client.RMProxy: Connecting to ResourceManager at node0/192.168.179.100:8032</span><br></pre></td></tr></table></figure>



<h4 id="实验3：获取container日志"><a href="#实验3：获取container日志" class="headerlink" title="实验3：获取container日志"></a>实验3：获取container日志</h4><h5 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h5><p>访问<code>Container</code>日志文件。</p>
<h5 id="解决办法："><a href="#解决办法：" class="headerlink" title="解决办法："></a>解决办法：</h5><p>使用<code>YARN</code>的<code>UI</code>和<code>命令行</code>访问日志。</p>
<h5 id="讨论："><a href="#讨论：" class="headerlink" title="讨论："></a>讨论：<img src="/img/Hadoop_YARN/image-20221006183721924.png" alt="image-20221006183721924"></h5><ul>
<li><code>Container</code>输出（如日志文件）写入本地文件系统。</li>
<li>如果没有启用日志聚合，本地日志文件将保留<code>yarn.nodemanager.log.retain-seconds</code>秒；</li>
<li>如果启用了日志聚合<code>yarn.log-aggregation-enable</code>，在<code>Application</code>执行完成后，所有<code>Container</code>的日志都会被复制到<code>HDFS</code>中，然后清除<code>slave</code>节点的日志，除非设置了<code>yarn.nodemanager.delete debug-delay-sec</code>。</li>
</ul>
<h4 id="实验4：聚合container日志"><a href="#实验4：聚合container日志" class="headerlink" title="实验4：聚合container日志"></a>实验4：聚合container日志</h4><p><img src="/img/Hadoop_YARN/image-20221006195055399.png" alt="image-20221006195055399"></p>
<h5 id="启用日志聚合"><a href="#启用日志聚合" class="headerlink" title="启用日志聚合"></a>启用日志聚合</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="通过UI访问聚合后的日志"><a href="#通过UI访问聚合后的日志" class="headerlink" title="通过UI访问聚合后的日志"></a>通过UI访问聚合后的日志</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://node1:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>启用<code>MR</code>日志服务器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[zhangsan@node1 ~]$ mr-jobhistory-daemon.sh start historyserver</span><br></pre></td></tr></table></figure>

<h5 id="访问HDFS-中的日志文件"><a href="#访问HDFS-中的日志文件" class="headerlink" title="访问HDFS 中的日志文件"></a>访问HDFS 中的日志文件</h5><p>默认情况下，聚合的日志文件将存入<code>HDFS</code>中的以下目录</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.remote-app-log-dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/tmp/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">source</span>&gt;</span>yarn-default.xml<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.remote-app-log-dir-suffix<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">source</span>&gt;</span>yarn-default.xml<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>即：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">/tmp/logs/$</span><span class="language-bash">&#123;user&#125;/logs/&lt;application-id&gt;/</span></span><br></pre></td></tr></table></figure>

<p>如果通过<code>WebUI</code>无法查看<code>HDFS</code>中的日志，进行如下配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.http.staticuser.user<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>zhangsan<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">source</span>&gt;</span>core-site.xml<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h5 id="本地文件系统和HDFS中的日志区别"><a href="#本地文件系统和HDFS中的日志区别" class="headerlink" title="本地文件系统和HDFS中的日志区别"></a>本地文件系统和HDFS中的日志区别</h5><p>每个<code>Container</code>在本地文件系统中生成两个日志文件：一个用于标准输出<code>stdout</code>，另一个用于标准错误输出<code>stderr</code>。</p>
<p>作为聚合过程的一部分，给定节点的所有文件将串联到特定于节点的日志中。例如，如果您有五个跨三个节点运行的<code>Container</code>，则最终会在 <code>HDFS</code> 中得到三个日志文件。</p>
<h5 id="日志压缩"><a href="#日志压缩" class="headerlink" title="日志压缩"></a>日志压缩</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.log-aggregation.compression-type<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>gzip或lzo<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="本地日志保留"><a href="#本地日志保留" class="headerlink" title="本地日志保留"></a>本地日志保留</h5><p>关闭日志聚合后，本地主机上的<code>Container</code>日志文件将保留 <code>yarn.nodemanager.log.retain-seconds</code>秒，默认值为 <code>10800</code>（3 小时）。</p>
<p>当日志聚合打开时，将忽略 <code>yarn.nodemanager.log.retain-seconds</code>控制，而是在将本地<code>Container</code>日志文件复制到 <code>HDFS</code> 后立即将其删除。但是，如果您想将它们保留在本地，进行如下配置，则所有内容都不会丢失，这不仅适用于日志文件，还适用于与<code>Container</code>关联的所有其他元数据（如 JAR 文件）。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.delete.debug-delay-sec<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>600<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="剖析-YARN-MapReduce-Application"><a href="#剖析-YARN-MapReduce-Application" class="headerlink" title="剖析 YARN MapReduce Application"></a>剖析 YARN MapReduce Application</h3><p><img src="/img/Hadoop_YARN/image-20221006193140932.png" alt="image-20221006193140932"></p>
<h3 id="YARN内存管理"><a href="#YARN内存管理" class="headerlink" title="YARN内存管理"></a>YARN内存管理</h3><p><code>NodeManager</code>存在于<code>Linux</code>系统中，<code>Container</code>存在于<code>NodeManager</code>中；所以</p>
<ul>
<li><p>NodeManager Memory &lt; Linux Memory</p>
</li>
<li><p>Container Memory &lt; NodeManager Memory</p>
</li>
</ul>
<h4 id="NodeManager内存管理"><a href="#NodeManager内存管理" class="headerlink" title="NodeManager内存管理"></a>NodeManager内存管理</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- yarn nodemanager允许管理的物理内存大小 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.memory-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Amount of physical memory, in MB, that can be allocated for containers. If set to -1 and yarn.nodemanager.resource.detect-hardware-capabilities is true, it is automatically calculated(in case of Windows and Linux). In other cases, the default is 8192MB.  NodeManager默认可管理8GB内存；如果value=-1 且 启用自动检测硬件能力 ，该值会自动计算<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.detect-hardware-capabilities<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Enable auto-detection of node capabilities such as memory and CPU.启用自动检测节点能力(CPU,Mem), 使用此配置项时，需要 设置yarn.nodemanager.resource.memory-mb=-1 <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="Container内存管理"><a href="#Container内存管理" class="headerlink" title="Container内存管理"></a>Container内存管理</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--yarn单个Container允许分配的最大最小物理内存 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.minimum-allocation-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>512<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">description</span>&gt;</span>The minimum allocation for every container request at the RM in MBs. Memory requests lower than this will be set to the value of this property. Additionally, a node manager that is configured to have less memory than this value will be shut down by the resource manager.容器的最小内存，nodemanager可管理的内存不能低于此值<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.maximum-allocation-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>3072<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>The maximum allocation for every container request at the RM in MBs. Memory requests higher than this will throw an InvalidResourceRequestException.容器的最大内存，对container的内存请求不能高于此值<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：上面是说的物理内存，不是虚拟内存！</p>
</blockquote>
<h4 id="内存不够"><a href="#内存不够" class="headerlink" title="内存不够"></a>内存不够</h4><p>如提示：containerID&#x3D;container_1645498549388_0001_02_000001] is running beyond virtual memory limits. Current usage: 100.0 MB of 1 GB physical memory used; 2.2 GB of 2.1 GB virtual memory used. Killing container.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.pmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Whether physical memory limits will be enforced for containers.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Whether virtual memory limits will be enforced for containers.<span class="tag">&lt;/<span class="name">description</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>或</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-pmem-ratio<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>4<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Ratio between virtual memory to physical memory when setting memory limits for containers. Container allocations are expressed in terms of physical memory, and virtual memory usage is allowed to exceed this allocation by this ratio.当启用内存检查时，设置虚拟内存与物理内存的比值<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>未验证。</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">XiaoQu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://www.studybigdata.cn/Hadoop/Hadoop_YARN/">http://www.studybigdata.cn/Hadoop/Hadoop_YARN/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hadoop/">Hadoop</a><a class="post-meta__tags" href="/tags/YARN/">YARN</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/HTML/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info"></div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/Hadoop/Hadoop/" title="Hadoop环境部署"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-15</div><div class="title">Hadoop环境部署</div></div></a></div><div><a href="/Hadoop/Hadoop_MapReduce/" title="Hadoop_MapReduce"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-15</div><div class="title">Hadoop_MapReduce</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/jin.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">XiaoQu</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">89</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">50</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">23</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/A-stranger"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#YARN%E6%A6%82%E8%A7%88"><span class="toc-number">1.</span> <span class="toc-text">YARN概览</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89%E6%8B%A9YARN"><span class="toc-number">1.1.</span> <span class="toc-text">为什么选择YARN</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#YARN%E6%98%AF%E4%B8%80%E4%B8%AA%E5%88%86%E5%B8%83%E5%BC%8F%E8%B0%83%E5%BA%A6%E5%99%A8%EF%BC%8C%E8%B4%9F%E8%B4%A3%E4%BB%A5%E4%B8%8B%E4%B8%A4%E4%B8%AA%E6%B4%BB%E5%8A%A8%EF%BC%9A"><span class="toc-number">1.1.0.1.</span> <span class="toc-text">YARN是一个分布式调度器，负责以下两个活动：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#YARN%E6%A6%82%E5%BF%B5%E5%92%8C%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">YARN概念和组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#YARN%E7%BB%84%E4%BB%B6%E5%8F%8A%E5%85%B6%E7%9B%B8%E4%BA%92%E4%BD%9C%E7%94%A8"><span class="toc-number">1.2.1.</span> <span class="toc-text">YARN组件及其相互作用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ResourceManager"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">ResourceManager</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NodeManager"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">NodeManager</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B8%E5%9E%8B%E7%9A%84YARN%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.2.2.</span> <span class="toc-text">典型的YARN应用程序</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ApplicationManager"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">ApplicationManager</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%8A%82%E7%82%B9%E5%86%85%E7%9A%84container"><span class="toc-number">1.2.3.</span> <span class="toc-text">单节点内的container</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#YARN%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.</span> <span class="toc-text">YARN配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8EYARN%E4%BA%A4%E4%BA%92"><span class="toc-number">1.4.</span> <span class="toc-text">与YARN交互</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C2%EF%BC%9A%E5%9C%A8YARN%E9%9B%86%E7%BE%A4%E4%B8%AD%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AA%E5%91%BD%E4%BB%A4"><span class="toc-number">1.4.1.</span> <span class="toc-text">实验2：在YARN集群中运行一个命令</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%EF%BC%9A%E6%82%A8%E5%B8%8C%E6%9C%9B%E5%9C%A8-Hadoop-%E9%9B%86%E7%BE%A4%E4%B8%AD%E7%9A%84%E8%8A%82%E7%82%B9%E4%B8%8A%E8%BF%90%E8%A1%8C-Linux-%E5%91%BD%E4%BB%A4%E3%80%82"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">问题：您希望在 Hadoop 集群中的节点上运行 Linux 命令。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%EF%BC%9A%E4%BD%BF%E7%94%A8%E4%B8%8E-Hadoop-%E6%8D%86%E7%BB%91%E5%9C%A8%E4%B8%80%E8%B5%B7%E7%9A%84DistributedShell%E7%A4%BA%E4%BE%8B%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E3%80%82"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">解决办法：使用与 Hadoop 捆绑在一起的DistributedShell示例应用程序。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8%EF%BC%9AStart-by-issuing-a-Linux-find-command-in-a-single-container"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">作用：Start by issuing a Linux find command in a single container:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9AApplication-ID%EF%BC%9F"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">如何确定Application ID？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E9%97%AD-YARN-Application"><span class="toc-number">1.4.1.5.</span> <span class="toc-text">关闭 YARN Application</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C3%EF%BC%9A%E8%8E%B7%E5%8F%96container%E6%97%A5%E5%BF%97"><span class="toc-number">1.4.2.</span> <span class="toc-text">实验3：获取container日志</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">问题：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%EF%BC%9A"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">解决办法：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%A8%E8%AE%BA%EF%BC%9A"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">讨论：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C4%EF%BC%9A%E8%81%9A%E5%90%88container%E6%97%A5%E5%BF%97"><span class="toc-number">1.4.3.</span> <span class="toc-text">实验4：聚合container日志</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%AF%E7%94%A8%E6%97%A5%E5%BF%97%E8%81%9A%E5%90%88"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">启用日志聚合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E8%BF%87UI%E8%AE%BF%E9%97%AE%E8%81%9A%E5%90%88%E5%90%8E%E7%9A%84%E6%97%A5%E5%BF%97"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">通过UI访问聚合后的日志</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BF%E9%97%AEHDFS-%E4%B8%AD%E7%9A%84%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">访问HDFS 中的日志文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%92%8CHDFS%E4%B8%AD%E7%9A%84%E6%97%A5%E5%BF%97%E5%8C%BA%E5%88%AB"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">本地文件系统和HDFS中的日志区别</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.4.3.5.</span> <span class="toc-text">日志压缩</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%97%A5%E5%BF%97%E4%BF%9D%E7%95%99"><span class="toc-number">1.4.3.6.</span> <span class="toc-text">本地日志保留</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%96%E6%9E%90-YARN-MapReduce-Application"><span class="toc-number">1.5.</span> <span class="toc-text">剖析 YARN MapReduce Application</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#YARN%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">1.6.</span> <span class="toc-text">YARN内存管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NodeManager%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">1.6.1.</span> <span class="toc-text">NodeManager内存管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Container%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">1.6.2.</span> <span class="toc-text">Container内存管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E4%B8%8D%E5%A4%9F"><span class="toc-number">1.6.3.</span> <span class="toc-text">内存不够</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Python/File_Demo/" title="No title">No title</a><time datetime="2023-10-29T12:14:04.028Z" title="Created 2023-10-29 20:14:04">2023-10-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Python/PaddlePaddle_JupyterNotebook/" title="PaddlePaddle Jupyter NoteBook">PaddlePaddle Jupyter NoteBook</a><time datetime="2023-06-26T09:14:00.000Z" title="Created 2023-06-26 17:14:00">2023-06-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/ChatGPT/" title="No title">No title</a><time datetime="2023-06-25T07:47:22.975Z" title="Created 2023-06-25 15:47:22">2023-06-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Python/Web_Framework/" title="Web Framework">Web Framework</a><time datetime="2023-06-24T11:14:00.000Z" title="Created 2023-06-24 19:14:00">2023-06-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/JavaEE/JavaEE_QA/" title="JavaEE FAQ">JavaEE FAQ</a><time datetime="2023-06-19T11:03:00.000Z" title="Created 2023-06-19 19:03:00">2023-06-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By XiaoQu</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>